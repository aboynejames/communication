<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src&#x2F;makefuture.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0pr2&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0pr2&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/llLogic.html">llLogic</a></li>
            
                <li><a href="..&#x2F;classes/makeProgramme.html">makeProgramme</a></li>
            
                <li><a href="..&#x2F;classes/MasterWatch.html">MasterWatch</a></li>
            
                <li><a href="..&#x2F;classes/PerSwimmer.html">PerSwimmer</a></li>
            
                <li><a href="..&#x2F;classes/pouchdbSettings.html">pouchdbSettings</a></li>
            
                <li><a href="..&#x2F;classes/recordQS.html">recordQS</a></li>
            
                <li><a href="..&#x2F;classes/SwimtimeController.html">SwimtimeController</a></li>
            
                <li><a href="..&#x2F;classes/ttHTML.html">ttHTML</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src&#x2F;makefuture.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
* Train TImer
*
* Start node.js  Train Timer
*
*
* @package    Train Timer make future &#x2F; build programme part of open sport project
* @copyright  Copyright (c) 2012 James Littlejohn
* @license    http:&#x2F;&#x2F;www.gnu.org&#x2F;licenses&#x2F;old-licenses&#x2F;gpl-2.0.html
* @version    0.1.0
*&#x2F;


&#x2F;**
* Builder a future programme of training
* @class makeProgramme
*&#x2F;
var makeProgramme = function() {
	this.status = &#x27;default&#x27;;
};

&#x2F;**
* Take in clicks&#x2F;input intentions
* @method makeLogic		
*
*&#x2F;	
makeProgramme.prototype.makeLogic = function(madeactionin, targetin) {
&#x2F;&#x2F;console.log(madeactionin + &#x27;from make class&#x27;);
 

        if (madeactionin == &quot;newelement&quot;)
				{			
					var livecurrentDate = $( &quot;#datepicker&quot; ).datepicker( &quot;getDate&quot; );
					$(&quot;#swimdate&quot;).text(livecurrentDate);
					
					&#x2F;&#x2F; communication counter id
					cci = new Date().getTime();
					
					&#x2F;&#x2F; set new current id
					currentliveelementid.push(cci);
					
					&#x2F;&#x2F;keep a list of unique ids
					uniqueelementids.push(cci);
&#x2F;&#x2F;console.log(uniqueelementids);
&#x2F;&#x2F;					currentliveelementid.push(cci);
&#x2F;&#x2F;console.log(currentliveelementid);					
&#x2F;&#x2F;console.log(&#x27;holding ids live in right order?&#x27;);					
					&#x2F;&#x2F; make HTML code for edit and un edit mode
					var livecommelemcode =liveHTML.commelementbuild(cci);
					$(&quot;.communicationelement&quot;).append(livecommelemcode);
					
					&#x2F;&#x2F; capture the element settings before hiding

					&#x2F;&#x2F;only if on second the do
					if(uniqueelementids.length &gt; 1)
					{
						&#x2F;&#x2F; hide previous edit element and show it in text mode
						&#x2F;&#x2F; work out current position and go back one
	&#x2F;&#x2F;console.log(uniqueelementids.length + &#x27;number of element in array&#x27;);
						var secondlastid =&#x27;&#x27;;
						if(uniqueelementids.length == 1)
						{
						 secondlastid = uniqueelementids[0];
						}
						else
						{
							secondlastid = uniqueelementids[(uniqueelementids.length - 2)];
						}
	&#x2F;&#x2F;console.log(secondlastid);
	&#x2F;&#x2F;console.log(uniqueelementids[secondlastid]);
						&#x2F;&#x2F; need to collect values set  #setauthored1374308817000 div.swimsettings div.swimsettingslabel select#swimtype.rightselect
					var divcapturelast = &quot;#setauthored&quot; + secondlastid + &quot; .swimsettings .swimsettingslabel select&quot;;
&#x2F;&#x2F;console.log(divcapturelast);						
						&#x2F;&#x2F; get all the set element data
					swimtype = $( divcapturelast + &quot;#swimtype&quot;).val();
					swimstroke = $( divcapturelast + &quot;#swimstroke&quot;).val();
					swimtechnique = $( divcapturelast + &quot;#swimtechnique&quot;).val();
					swimdistance = $( divcapturelast + &quot;#swimdistance&quot;).val();
					swimrepetition = $( divcapturelast + &quot;#swimrepetition&quot;).val();
&#x2F;&#x2F;console.log(&#x27;reps=&#x27; + swimrepetition);	
						&#x2F;&#x2F;now set the text version settings  #editdate1374309051000.editswimelement div#swimrepetition
					var textmodesettings = &quot;#editdate&quot; + secondlastid + &quot;.editswimelement &quot;;					
					$(textmodesettings + &quot;#swimtype&quot;).text(swimtype);
					$(textmodesettings + &quot;#swimstroke&quot;).text(swimstroke);
					$(textmodesettings + &quot;#swimtechnique&quot;).text(swimtechnique);
					$(textmodesettings + &quot;#swimdistance&quot;).text(swimdistance);
					$(textmodesettings + &quot;#swimrepetition&quot;).text(swimrepetition);			
						
					$(&quot;#communicationelement&quot; + secondlastid ).hide();
						
					$(&quot;#editdate&quot; + secondlastid ).show();
					}
					
				&#x2F;&#x2F; hide plain text view
				$(&quot;#editdate&quot; + cci).hide();
				&#x2F;&#x2F; from the set authoring tool abstract
				$(&quot;#setauthored&quot; + cci ).html($(&quot;#setsettings&quot;).html());
				$(&quot;.swimsettings&quot;).show();					
					
				}
				else if (targetin.attr(&quot;id&quot;) == &quot;edit&quot;)
				{
&#x2F;&#x2F;console.log($sotgt[0].dataset.editid);					
					&#x2F;&#x2F; need to capture edit data id
					 &#x2F;&#x2F;var emi = $(&quot;#edit&quot;).attr(&#x27;data-editid&#x27;);
					var emi = targetin.data(&quot;editid&quot;);
										&#x2F;&#x2F; set new current id
					currentliveelementid.push(parseInt(emi) );
					&#x2F;&#x2F; make this text view into form view
					$(&quot;#communicationelement&quot; + emi).show();
					$(&quot;#editdate&quot; + emi ).hide();
						var textmodesettings = &quot;#editdate&quot; + emi + &quot;.editswimelement &quot;;					
						eswimtype = $(textmodesettings + &quot;#swimtype&quot;).text();
						eswimstroke = $(textmodesettings + &quot;#swimstroke&quot;).text();
						eswimtechnique = $(textmodesettings + &quot;#swimtechnique&quot;).text();
						eswimdistance = $(textmodesettings + &quot;#swimdistance&quot;).text();
						eswimrepetition = $(textmodesettings + &quot;#swimrepetition&quot;).text();		

					&#x2F;&#x2F; and set the form values
						$( divcapturelast + &quot;#swimtype&quot;).val(eswimtype);
						$( divcapturelast + &quot;#swimstroke&quot;).val(eswimstroke);
						$( divcapturelast + &quot;#swimtechnique&quot;).val(eswimtechnique);
						$( divcapturelast + &quot;#swimdistance&quot;).val(eswimdistance);
						$( divcapturelast + &quot;#swimrepetition&quot;).val(eswimrepetition);
	
					&#x2F;&#x2F; the previous id coud by any element, need to track
					&#x2F;&#x2F; speical case if length of array 1 then only -1
					if(uniqueelementids.length &gt; 1)
					{
						previousid = currentliveelementid.length - 2;
						&#x2F;&#x2F;console.log(currentliveelementid);					
&#x2F;&#x2F;console.log(currentliveelementid.length);					
&#x2F;&#x2F;console.log(previousid);					
&#x2F;&#x2F;console.log(currentliveelementid[previousid] + &#x27;current elementlive ie last in array&#x27;);					
					$(&quot;#editdate&quot; + currentliveelementid[previousid] ).show();
					$(&quot;#communicationelement&quot; + currentliveelementid[previousid] ).hide();
					&#x2F;&#x2F; turn element before to text view
						var divcapturelast = &quot;#setauthored&quot; + currentliveelementid[previousid]  + &quot; .swimsettings .swimsettingslabel select&quot;;
&#x2F;&#x2F;console.log(divcapturelast);						
							&#x2F;&#x2F; get all the set element data
						swimtype = $( divcapturelast + &quot;#swimtype&quot;).val();
						swimstroke = $( divcapturelast + &quot;#swimstroke&quot;).val();
						swimtechnique = $( divcapturelast + &quot;#swimtechnique&quot;).val();
						swimdistance = $( divcapturelast + &quot;#swimdistance&quot;).val();
						swimrepetition = $( divcapturelast + &quot;#swimrepetition&quot;).val();
&#x2F;&#x2F;console.log(&#x27;reps=&#x27; + swimrepetition);	
							&#x2F;&#x2F;now set the text version settings  #editdate1374309051000.editswimelement div#swimrepetition
						var textmodesettings = &quot;#editdate&quot; + currentliveelementid[previousid]  + &quot;.editswimelement &quot;;					
						$(textmodesettings + &quot;#swimtype&quot;).text(swimtype);
						$(textmodesettings + &quot;#swimstroke&quot;).text(swimstroke);
						$(textmodesettings + &quot;#swimtechnique&quot;).text(swimtechnique);
						$(textmodesettings + &quot;#swimdistance&quot;).text(swimdistance);
						$(textmodesettings + &quot;#swimrepetition&quot;).text(swimrepetition);	
					}
					else
					{
						previousid =  targetin.data(&quot;editid&quot;); &#x2F;&#x2F;$sotgt[0].dataset.editid;
&#x2F;&#x2F;console.log($sotgt[0].dataset.editid + &#x27;in else mode&#x27;);						
					$(&quot;#communicationelement&quot; +  targetin.data(&quot;editid&quot;)).show();
					$(&quot;#editdate&quot; +  targetin.data(&quot;editid&quot;) ).hide();
					}

					
				}
				else if (madeactionin == &quot;save&quot;)
				{
					&#x2F;&#x2F; need to capture remove id number
					 var smi = $(&quot;#save&quot;).attr(&#x27;data-saveid&#x27;);
					$(&quot;#save&quot; + smi).remove();
					$(&#x27;&lt;div class=&quot;editel&quot;&gt;&lt;a href=&quot;&quot; id=&quot;edit&#x27; + smi + &#x27;&quot;&gt;edit&lt;&#x2F;a&gt;&lt;&#x2F;div&gt;&#x27;).appendTo(&quot;#communicationelement&quot; + smi );
					
				}
				else if (targetin.attr(&quot;id&quot;) == &quot;remove&quot;)
				{
&#x2F;&#x2F;console.log($sotgt[0].dataset.removeid);						
					&#x2F;&#x2F; need to capture remove id number
					var rmi = targetin.data(&quot;removeid&quot;);    &#x2F;&#x2F; $sotgt[0].dataset.removeid;
					&#x2F;&#x2F; need to remove from tracking arrays
					newinnumber = parseInt(rmi);
					var indexunique = uniqueelementids.indexOf(newinnumber);
					var indexcurrent = currentliveelementid.indexOf(newinnumber);
					uniqueelementids.splice(indexunique, 1);
					currentliveelementid.splice(indexcurrent, 1); 
			
					$(&quot;#communicationelement&quot; + rmi ).remove();
					$(&quot;#editdate&quot; + rmi ).remove();
&#x2F;&#x2F;console.log(uniqueelementids);
&#x2F;&#x2F;console.log(currentliveelementid);	
				}
				else if (madeactionin == &quot;savecommunication&quot;)
				{
					&#x2F;&#x2F; collect the date
					var datein = $( &quot;#datepicker&quot; ).datepicker( &quot;getDate&quot; );		
console.log(datein);					
					&#x2F;&#x2F; get a list of the unique ids and loop through to extract information
					var smi = $(&quot;.communicationelement&quot;);
&#x2F;&#x2F;console.log(smi);
					var smic = $(&quot;.communicationelement&quot;).children();
&#x2F;&#x2F;console.log(smic);
					var smiclength = $(&quot;.communicationelement&quot;).children().length;
&#x2F;&#x2F;console.log(smiclength);	
					
				&#x2F;&#x2F; check to see if a date exists if not, promp to add a date
				if(datein == null || smiclength == 0)
				{
					var feedbackcomm = &#x27;&#x27;;
					if(datein == null)
					{
						feedbackcomm = &#x27;Please add a date&#x27;;;
					}
					if(smiclength == 0)
					{
						feedbackcomm += &#x27; Please add a communication element&#x27;;
					}
					$(&quot;.commfeedback&quot;).html(feedbackcomm);
				}
				else
				{
				$(&quot;.commfeedback&quot;).empty();
				$(&quot;.liveswimset&quot;).empty();
				sdaterecord = &#x27;&#x27;;
					
				&#x2F;**
				* save one document
				* @method singleSave
				*&#x2F;
				function savecommunicationset (datein, commgroupdata, smlength) {	
	&#x2F;&#x2F;console.log(Date.parse(datein));
					var datestringday = Date.parse(datein);

						swimgroupcomm = {};
						newjsoncomm = {};
							
						&#x2F;&#x2F;var chdiv = Object.keys(commgroupdata);
						commgroupdata.forEach(function(dataid) {
&#x2F;&#x2F;console.log(&#x27;in the loop&#x27; + dataid);	
			&#x2F;&#x2F;console.log(smic[dataid].dataset);
						&#x2F;&#x2F;#setauthored1373464381000 #swimsettings select#swimrepetition
						&#x2F;&#x2F;sample = &quot;#setauthored&quot; + commelidin + &quot; .swimsettings .swimsettingslabel select#swimtype&quot;;
				
						var divcapturein = &quot;#setauthored&quot; + dataid + &quot; .swimsettings .swimsettingslabel select&quot;;		
							&#x2F;&#x2F; get all the set element data
						swimtype = $( divcapturein + &quot;#swimtype&quot;).val();
						swimstroke = $( divcapturein + &quot;#swimstroke&quot;).val();
						swimtechnique = $( divcapturein + &quot;#swimtechnique&quot;).val();
						swimdistance = $( divcapturein + &quot;#swimdistance&quot;).val();
						swimrepetition = $( divcapturein + &quot;#swimrepetition&quot;).val();
		&#x2F;&#x2F;console.log(&#x27;reps=&#x27; + swimrepetition);			

						&#x2F;&#x2F; collect into object and save via pouchdb.
						&#x2F;&#x2F; form swim data
						swimcommstatus = {};
						swimcommstatus[&#x27;commdate&#x27;] = datein;
						swimcommstatus[&#x27;commtype&#x27;] = swimtype;
						swimcommstatus[&#x27;commstroke&#x27;] = swimstroke;
						swimcommstatus[&#x27;commtechnique&#x27;] = swimtechnique;
						swimcommstatus[&#x27;commdistance&#x27;] = swimdistance;
						swimcommstatus[&#x27;commrepetition&#x27;] = swimrepetition;
&#x2F;&#x2F;console.log(dataid + &#x27;what&#x27;);
						
						swimgroupcomm[dataid] = swimcommstatus;
					&#x2F;&#x2F; save to localpouchdb need to prepare buld array json structure
														
						newjsoncomm[&quot;commid&quot;] = datein;&#x2F;&#x2F;commgroupdata[dataid].dataset.commid;
						newjsoncomm[&quot;commdate&quot;] = Date.parse(datein);
						newjsoncomm[&quot;swimmerid&quot;] = [11111111,222222,333333];
						newjsoncomm[&quot;communication&quot;] = swimgroupcomm;	
&#x2F;&#x2F;console.log(newjsoncomm);					

							
						});
&#x2F;&#x2F;console.log(&#x27;before save&#x27;);				
&#x2F;&#x2F;console.log(newjsoncomm);					
						livepouch.singleSave(newjsoncomm);

						$(&quot;#canvasDiv&quot;).hide();
							
						} &#x2F;&#x2F; closes function	
							
					var smonth = datein.getUTCMonth() + 1;
					var sday = datein.getDate();
					var syear = datein.getUTCFullYear();
					var sdaterecord = sday + &#x27;&#x2F;&#x27; + smonth + &#x27;&#x2F;&#x27; + syear;
												
						var dateid = &#x27;&lt;div class=&quot;swimcommdate&quot;&gt;&lt;a href=&quot;&quot; id=&quot;fpdate&quot; data-dcommid=&quot;&#x27; + Date.parse(datein) + &#x27;&quot; &gt;&#x27; + sdaterecord + &#x27;&lt;&#x2F;a&gt;&lt;&#x2F;div&gt;&#x27;;
						$(dateid).appendTo(&quot;.pastfuturecomm&quot;);

						&#x2F;&#x2F; pass the data over for saving
						savecommunicationset(datein, uniqueelementids, smiclength);
						&#x2F;&#x2F; NEED TO CLEAR UNIQUE AND HISTORY ARRAYS
						uniqueelementids = [];
						currentliveelementid = [];
						
&#x2F;&#x2F;console.log(&#x27;before empty call&#x27;);
						$(&quot;.communicationelement&quot;).empty();
				}
				}
			
				else if (madeactionin == &quot;sketchpad&quot;)
				{
					&#x2F;&#x2F; show the canvas sketchpad UI
					var smi = 1;
					&#x2F;&#x2F;$(&quot;#sketchpad&quot; + smi).html($(&quot;#canvasDiv&quot;).html());
						$(&quot;#canvasDiv&quot;).show();
				}
	
};
	 
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
